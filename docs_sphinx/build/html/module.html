
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>module package &#8212; WP6_QNLP 0.3 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-package">
<h1>module package<a class="headerlink" href="#module-package" title="Permalink to this headline">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-module.DressedQuantumNet">
<span id="module-dressedquantumnet-module"></span><h2>module.DressedQuantumNet module<a class="headerlink" href="#module-module.DressedQuantumNet" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="module.DressedQuantumNet.DressedQuantumNet">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">module.DressedQuantumNet.</span></span><span class="sig-name descname"><span class="pre">DressedQuantumNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Sentence</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/module/DressedQuantumNet.html#DressedQuantumNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#module.DressedQuantumNet.DressedQuantumNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Neural Network Classifier with Forward Method.</p>
<p>Defines the Dressed Quantum Neural Network Classifier for a Sentence. A feed forward step is also defined for later training along with supporting methods.
This class implements the pre processing neural network needed to reduce the dimensionality of BERT embeddings. A dimension for an intermediate representation, as well as the max and min numbers of parameters that are expected to appear in the circuits is also provided. A different number of layers will be applied depending of the numbers of parameters needed to encode that word.
When the circuit is run using pytket and AerBackend(), the tensor network nature of the parameters is lost, and all we is a classical bitstring and some probabilities. Alternative options like using differentiable Pennylane circuits could solve this issue. An interface between Pennylane and tket exists and it is worth looking into it.</p>
<dl class="simple">
<dt>Sentence<span class="classifier">str</span></dt><dd><p>Input Sentence</p>
</dd>
<dt>QNParamWords<span class="classifier">list</span></dt><dd><p>Number of parameters for each word.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="module.DressedQuantumNet.DressedQuantumNet.Measure_s_qubits">
<span class="sig-name descname"><span class="pre">Measure_s_qubits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Circuit</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/module/DressedQuantumNet.html#DressedQuantumNet.Measure_s_qubits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#module.DressedQuantumNet.DressedQuantumNet.Measure_s_qubits" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtains unmeasured qubits meausrements.</p>
<p>In the DisCoCat pytket circuits the sentence qubits are not measured, and thus additional measurements
need to be performed. Otherwise, we will get bitsrings shorter than the number of qubits of the circuits, 
corresponding only to the post selected ones.:</p>
<dl class="simple">
<dt>sen_c_regs: list</dt><dd><p>list of measurements.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="module.DressedQuantumNet.DressedQuantumNet.calculate_bitstring">
<span class="sig-name descname"><span class="pre">calculate_bitstring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_qubits</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/module/DressedQuantumNet.html#DressedQuantumNet.calculate_bitstring"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#module.DressedQuantumNet.DressedQuantumNet.calculate_bitstring" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds bitstrings for each qubit.</p>
<p>s_qubits:</p>
<p>all_bitstrings: list</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="module.DressedQuantumNet.DressedQuantumNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/module/DressedQuantumNet.html#DressedQuantumNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#module.DressedQuantumNet.DressedQuantumNet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs forward step in neural network.</p>
<p>Takes a list of sentences and find a Bert embedding for each.:</p>
<dl class="simple">
<dt>result_dict.values(): list</dt><dd><p>Outputs a two-dimensional list of floats that represents the classification of the Neural Network. True corresponds to [1,0] and False correseponds to [0,1]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="module.DressedQuantumNet.DressedQuantumNet.get_norm_circuit_output">
<span class="sig-name descname"><span class="pre">get_norm_circuit_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_qubits</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/module/DressedQuantumNet.html#DressedQuantumNet.get_norm_circuit_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#module.DressedQuantumNet.DressedQuantumNet.get_norm_circuit_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtains normalised output of parametrised quantum circuit.</p>
<p>counts:</p>
<p>s_qubits:</p>
<p>self.norm_probs(prob_result): dict</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="module.DressedQuantumNet.DressedQuantumNet.list2bitstring">
<span class="sig-name descname"><span class="pre">list2bitstring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bitlist</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/module/DressedQuantumNet.html#DressedQuantumNet.list2bitstring"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#module.DressedQuantumNet.DressedQuantumNet.list2bitstring" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts bit list to bit string.</p>
<p>bitlist: str</p>
<p>bitstring: str</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="module.DressedQuantumNet.DressedQuantumNet.norm_probs">
<span class="sig-name descname"><span class="pre">norm_probs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prob_result</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/module/DressedQuantumNet.html#DressedQuantumNet.norm_probs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#module.DressedQuantumNet.DressedQuantumNet.norm_probs" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalises values in dictionary</p>
<p>prob_result: dict</p>
<p>prob_result: dict</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="module.DressedQuantumNet.DressedQuantumNet.satisfy_post_selection">
<span class="sig-name descname"><span class="pre">satisfy_post_selection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">post_selection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/module/DressedQuantumNet.html#DressedQuantumNet.satisfy_post_selection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#module.DressedQuantumNet.DressedQuantumNet.satisfy_post_selection" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks post selection criteria for circuit.</p>
<p>This is used to tell if the output bitstrings satify the post selection conditions given by the ciruit.:</p>
<p>post_selection: iterable</p>
<p>result: iterable</p>
<p>bool</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-module.Qsentence">
<span id="module-qsentence-module"></span><h2>module.Qsentence module<a class="headerlink" href="#module-module.Qsentence" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="module.Qsentence.Qsentence">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">module.Qsentence.</span></span><span class="sig-name descname"><span class="pre">Qsentence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sentence_string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/module/Qsentence.html#Qsentence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#module.Qsentence.Qsentence" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Generates Parametrised Quantum Circuit and Bert Word Embedding for a Sentence.</p>
<p>Obtains parametrised quantum circuit and word embeddings for the sentence. Also contains attributes pertaining to the parameters in the PQC aswell as the</p>
<dl class="simple">
<dt>label<span class="classifier">optional, list, bool, NoneType</span></dt><dd><p>Mapping of True:[1,0] and False:[0,1].</p>
</dd>
<dt>parameters<span class="classifier">tk_circuit.free_symbols()</span></dt><dd><p>The parameters in the quantum circuit that correspond to the words in the sentence.</p>
</dd>
<dt>embeddings<span class="classifier">list</span></dt><dd><p>The sentence embedding.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="module.Qsentence.Qsentence.GetNParamsWord">
<span class="sig-name descname"><span class="pre">GetNParamsWord</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/module/Qsentence.html#Qsentence.GetNParamsWord"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#module.Qsentence.Qsentence.GetNParamsWord" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the number of quantum parameters corrseponding to each word in the sentence.</p>
<dl class="simple">
<dt>params_per_word: list</dt><dd><p>Number of parameters for each word.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="module.Qsentence.Qsentence.get_sentence_BERT_embeddings">
<span class="sig-name descname"><span class="pre">get_sentence_BERT_embeddings</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/module/Qsentence.html#Qsentence.get_sentence_BERT_embeddings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#module.Qsentence.Qsentence.get_sentence_BERT_embeddings" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns word embedding for each sentence.</p>
<p>Takes a list of sentences and find a Bert embedding for each.:</p>
<dl class="simple">
<dt>Sentences_Embeddings: list</dt><dd><p>List consisting of word embeddings for each sentence.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-module.bert_text_preparation">
<span id="module-bert-text-preparation-module"></span><h2>module.bert_text_preparation module<a class="headerlink" href="#module-module.bert_text_preparation" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="module.bert_text_preparation.bert_text_preparation">
<span class="sig-prename descclassname"><span class="pre">module.bert_text_preparation.</span></span><span class="sig-name descname"><span class="pre">bert_text_preparation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PreTrainedTokenizer(name_or_path='bert-base-uncased',</span> <span class="pre">vocab_size=30522,</span> <span class="pre">model_max_len=512,</span> <span class="pre">is_fast=False,</span> <span class="pre">padding_side='right',</span> <span class="pre">truncation_side='right',</span> <span class="pre">special_tokens={'unk_token':</span> <span class="pre">'[UNK]',</span> <span class="pre">'sep_token':</span> <span class="pre">'[SEP]',</span> <span class="pre">'pad_token':</span> <span class="pre">'[PAD]',</span> <span class="pre">'cls_token':</span> <span class="pre">'[CLS]',</span> <span class="pre">'mask_token':</span> <span class="pre">'[MASK]'})</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/module/bert_text_preparation.html#bert_text_preparation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#module.bert_text_preparation.bert_text_preparation" title="Permalink to this definition">¶</a></dt>
<dd><p>Tokenises sentence.</p>
<p>Uses Bert Tokeniser to tokenise a sentence(string). It returns the tokenized text, tokens tensor and segments tensors.:</p>
<dl class="simple">
<dt>text<span class="classifier">str</span></dt><dd><p>A sentence to be tokenised.</p>
</dd>
<dt>tokeniser<span class="classifier">tokenizer</span></dt><dd><p>The tokeniser being used. The default is set to the transformers pretrained bert tokeniser.</p>
</dd>
</dl>
<p>(tokenized_text, tokens_tensor, segments_tensors): tuple</p>
</dd></dl>

</section>
<section id="module-module.data_preparation">
<span id="module-data-preparation-module"></span><h2>module.data_preparation module<a class="headerlink" href="#module-module.data_preparation" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="module.data_preparation.data_preparation">
<span class="sig-prename descclassname"><span class="pre">module.data_preparation.</span></span><span class="sig-name descname"><span class="pre">data_preparation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/module/data_preparation.html#data_preparation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#module.data_preparation.data_preparation" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms sentences into Qsentences.</p>
<p>Takes sentence train and test data along with their repective true or false labels and transforms each sentence into a so-called Qsentence.:</p>
<dl class="simple">
<dt>filename<span class="classifier">str</span></dt><dd><p>File path to the data to be prepared</p>
</dd>
</dl>
<dl class="simple">
<dt>Dataset: list</dt><dd><p>List of Qsentence types corresponding to each sentence.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-module.get_bert_embeddings">
<span id="module-get-bert-embeddings-module"></span><h2>module.get_bert_embeddings module<a class="headerlink" href="#module-module.get_bert_embeddings" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="module.get_bert_embeddings.get_bert_embeddings">
<span class="sig-prename descclassname"><span class="pre">module.get_bert_embeddings.</span></span><span class="sig-name descname"><span class="pre">get_bert_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tokens_tensor</span></em>, <em class="sig-param"><span class="pre">segments_tensors</span></em>, <em class="sig-param"><span class="pre">model=BertModel(</span>&#160;&#160; <span class="pre">(embeddings):</span> <span class="pre">BertEmbeddings(</span>&#160;&#160;&#160;&#160; <span class="pre">(word_embeddings):</span> <span class="pre">Embedding(30522</span></em>, <em class="sig-param"><span class="pre">768</span></em>, <em class="sig-param"><span class="pre">padding_idx=0)</span>&#160;&#160;&#160;&#160; <span class="pre">(position_embeddings):</span> <span class="pre">Embedding(512</span></em>, <em class="sig-param"><span class="pre">768)</span>&#160;&#160;&#160;&#160; <span class="pre">(token_type_embeddings):</span> <span class="pre">Embedding(2</span></em>, <em class="sig-param"><span class="pre">768)</span>&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160; <span class="pre">)</span>&#160;&#160; <span class="pre">(encoder):</span> <span class="pre">BertEncoder(</span>&#160;&#160;&#160;&#160; <span class="pre">(layer):</span> <span class="pre">ModuleList(</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(0):</span> <span class="pre">BertLayer(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(attention):</span> <span class="pre">BertAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(self):</span> <span class="pre">BertSelfAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(query):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(key):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(value):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertSelfOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate):</span> <span class="pre">BertIntermediate(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=3072</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate_act_fn):</span> <span class="pre">GELUActivation()</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=3072</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(1):</span> <span class="pre">BertLayer(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(attention):</span> <span class="pre">BertAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(self):</span> <span class="pre">BertSelfAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(query):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(key):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(value):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertSelfOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate):</span> <span class="pre">BertIntermediate(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=3072</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate_act_fn):</span> <span class="pre">GELUActivation()</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=3072</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(2):</span> <span class="pre">BertLayer(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(attention):</span> <span class="pre">BertAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(self):</span> <span class="pre">BertSelfAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(query):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(key):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(value):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertSelfOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate):</span> <span class="pre">BertIntermediate(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=3072</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate_act_fn):</span> <span class="pre">GELUActivation()</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=3072</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(3):</span> <span class="pre">BertLayer(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(attention):</span> <span class="pre">BertAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(self):</span> <span class="pre">BertSelfAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(query):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(key):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(value):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertSelfOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate):</span> <span class="pre">BertIntermediate(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=3072</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate_act_fn):</span> <span class="pre">GELUActivation()</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=3072</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(4):</span> <span class="pre">BertLayer(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(attention):</span> <span class="pre">BertAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(self):</span> <span class="pre">BertSelfAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(query):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(key):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(value):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertSelfOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate):</span> <span class="pre">BertIntermediate(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=3072</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate_act_fn):</span> <span class="pre">GELUActivation()</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=3072</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(5):</span> <span class="pre">BertLayer(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(attention):</span> <span class="pre">BertAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(self):</span> <span class="pre">BertSelfAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(query):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(key):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(value):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertSelfOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate):</span> <span class="pre">BertIntermediate(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=3072</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate_act_fn):</span> <span class="pre">GELUActivation()</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=3072</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(6):</span> <span class="pre">BertLayer(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(attention):</span> <span class="pre">BertAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(self):</span> <span class="pre">BertSelfAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(query):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(key):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(value):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertSelfOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate):</span> <span class="pre">BertIntermediate(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=3072</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate_act_fn):</span> <span class="pre">GELUActivation()</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=3072</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(7):</span> <span class="pre">BertLayer(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(attention):</span> <span class="pre">BertAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(self):</span> <span class="pre">BertSelfAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(query):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(key):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(value):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertSelfOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate):</span> <span class="pre">BertIntermediate(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=3072</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate_act_fn):</span> <span class="pre">GELUActivation()</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=3072</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(8):</span> <span class="pre">BertLayer(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(attention):</span> <span class="pre">BertAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(self):</span> <span class="pre">BertSelfAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(query):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(key):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(value):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertSelfOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate):</span> <span class="pre">BertIntermediate(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=3072</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate_act_fn):</span> <span class="pre">GELUActivation()</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=3072</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(9):</span> <span class="pre">BertLayer(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(attention):</span> <span class="pre">BertAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(self):</span> <span class="pre">BertSelfAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(query):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(key):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(value):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertSelfOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate):</span> <span class="pre">BertIntermediate(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=3072</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate_act_fn):</span> <span class="pre">GELUActivation()</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=3072</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(10):</span> <span class="pre">BertLayer(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(attention):</span> <span class="pre">BertAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(self):</span> <span class="pre">BertSelfAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(query):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(key):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(value):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertSelfOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate):</span> <span class="pre">BertIntermediate(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=3072</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate_act_fn):</span> <span class="pre">GELUActivation()</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=3072</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(11):</span> <span class="pre">BertLayer(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(attention):</span> <span class="pre">BertAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(self):</span> <span class="pre">BertSelfAttention(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(query):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(key):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(value):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertSelfOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate):</span> <span class="pre">BertIntermediate(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=3072</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(intermediate_act_fn):</span> <span class="pre">GELUActivation()</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(output):</span> <span class="pre">BertOutput(</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=3072</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(LayerNorm):</span> <span class="pre">LayerNorm((768</span></em>, <em class="sig-param"><span class="pre">)</span></em>, <em class="sig-param"><span class="pre">eps=1e-12</span></em>, <em class="sig-param"><span class="pre">elementwise_affine=True)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(dropout):</span> <span class="pre">Dropout(p=0.1</span></em>, <em class="sig-param"><span class="pre">inplace=False)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160;&#160;&#160; <span class="pre">)</span>&#160;&#160; <span class="pre">)</span>&#160;&#160; <span class="pre">(pooler):</span> <span class="pre">BertPooler(</span>&#160;&#160;&#160;&#160; <span class="pre">(dense):</span> <span class="pre">Linear(in_features=768</span></em>, <em class="sig-param"><span class="pre">out_features=768</span></em>, <em class="sig-param"><span class="pre">bias=True)</span>&#160;&#160;&#160;&#160; <span class="pre">(activation):</span> <span class="pre">Tanh()</span>&#160;&#160; <span class="pre">)</span> <span class="pre">)</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/module/get_bert_embeddings.html#get_bert_embeddings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#module.get_bert_embeddings.get_bert_embeddings" title="Permalink to this definition">¶</a></dt>
<dd><p>Word embeddings for each word in a sentence.</p>
<p>Returns word embeddings for each token in a sentence.:</p>
<dl class="simple">
<dt>tokens_tensor:tokens_tensor</dt><dd><p>Tensor of tokens for a sentence</p>
</dd>
<dt>segments_tensors:segments_tensor</dt><dd><p>Tensor of segments of a sentence</p>
</dd>
<dt>model:Embedding_Model</dt><dd><p>Word embedding model to be used. The default is set to the Bert Model.</p>
</dd>
</dl>
<dl class="simple">
<dt>list_token_embeddings: list</dt><dd><p>List consisting of word embeddings for each token in the sentence.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-module.get_sentence_bert_embeddings">
<span id="module-get-sentence-bert-embeddings-module"></span><h2>module.get_sentence_bert_embeddings module<a class="headerlink" href="#module-module.get_sentence_bert_embeddings" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="module.get_sentence_bert_embeddings.get_sentence_bert_embeddings">
<span class="sig-prename descclassname"><span class="pre">module.get_sentence_bert_embeddings.</span></span><span class="sig-name descname"><span class="pre">get_sentence_bert_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SenList</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/module/get_sentence_bert_embeddings.html#get_sentence_bert_embeddings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#module.get_sentence_bert_embeddings.get_sentence_bert_embeddings" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns word embedding for each sentence.</p>
<p>Takes a list of sentences and find a Bert embedding for each.:</p>
<dl class="simple">
<dt>SenList: list</dt><dd><p>list of strings that represent each sentence.</p>
</dd>
</dl>
<dl class="simple">
<dt>Sentences_Embeddings: list</dt><dd><p>List consisting of word embeddings for each sentence.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-module.training">
<span id="module-training-module"></span><h2>module.training module<a class="headerlink" href="#module-module.training" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="module.training.training">
<span class="sig-prename descclassname"><span class="pre">module.training.</span></span><span class="sig-name descname"><span class="pre">training</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#module.DressedQuantumNet.DressedQuantumNet" title="module.DressedQuantumNet.DressedQuantumNet"><span class="pre">module.DressedQuantumNet.DressedQuantumNet</span></a></span></span><a class="reference internal" href="_modules/module/training.html#training"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#module.training.training" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains Dressed Quantum Neural Network Classfier.</p>
<p>Takes in a list of Qsentence types and trains a Dressed Quantum Network using PyTorch.:</p>
<dl class="simple">
<dt>Dataset<span class="classifier">list</span></dt><dd><p>list of Qsentence types.</p>
</dd>
</dl>
<dl class="simple">
<dt>DressedNet: DressedQuantumNet</dt><dd><p>Trained dressed quantum netowrk model</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-module">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-module" title="Permalink to this headline">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">WP6_QNLP</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">Quantum Natural Language Processing : NEASQC WP6.1</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Richard Wolf, Conor Dunne, Pablo Suarez Vieites.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/module.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>